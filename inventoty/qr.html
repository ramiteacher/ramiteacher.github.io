<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>QR ì¸ì‹ ì¬ê³  ê´€ë¦¬</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://accounts.google.com/gsi/client" async defer>
if (!sheetId) {
  const saved = sessionStorage.getItem("sheetId");
  if (saved) {
    location.href = `qr.html?sheetId=${saved}`;
  }
}

</script>
  <script src="https://unpkg.com/html5-qrcode">
if (!sheetId) {
  const saved = sessionStorage.getItem("sheetId");
  if (saved) {
    location.href = `qr.html?sheetId=${saved}`;
  }
}

</script>
  <link rel="stylesheet" href="style.css" />
  <!-- PWA ê´€ë ¨ ë©”íƒ€íƒœê·¸ ë° ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ë§í¬ ì¶”ê°€ -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#00f0ff" />
  <link rel="apple-touch-icon" href="icon-192.png" />
  <style>
    .top-button {
      background-color: #1e293b;
      color: #00f0ff;
      padding: 6px 12px;
      border-radius: 8px;
      font-weight: bold;
      border: 1px solid #00f0ff;
      margin-left: 6px;
      cursor: pointer;
    }
    .top-button:hover {
      background-color: #00f0ff;
      color: #000;
    }
    
    /* ì„¤ì¹˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    #installButton {
      background-color: #00f0ff;
      color: #000;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      margin: 10px auto;
      display: block;
      font-size: 16px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    #installButton:hover {
      background-color: #00d6e0;
      transform: translateY(-2px);
      transition: all 0.2s;
    }

    /* ì•± ì„¤ì¹˜ ì•ˆë‚´ ë°°ë„ˆ */
    #installBanner {
      display: none;
      background-color: rgba(30, 41, 59, 0.95);
      color: white;
      padding: 15px;
      border-radius: 10px;
      margin: 10px auto;
      max-width: 480px;
      border: 2px solid #00f0ff;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      position: relative;
      z-index: 1000;
    }

    .banner-title {
      font-weight: bold;
      color: #00f0ff;
      margin-bottom: 8px;
      font-size: 18px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .banner-close {
      position: absolute;
      right: 10px;
      top: 10px;
      background: none;
      border: none;
      color: #00f0ff;
      font-size: 18px;
      cursor: pointer;
    }
    
    /* í™ˆ í™”ë©´ì— ì¶”ê°€ ê°€ì´ë“œ */
    .install-guide {
      margin-top: 8px;
      padding: 8px;
      border-left: 3px solid #00f0ff;
      font-size: 14px;
    }
    
    /* ì…ê³ , ì¶œê³  ë“± ë²„íŠ¼ì„ ë°”ë¡œ ë³´ì´ê²Œ í•¨ */
    .action-buttons {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background-color: rgba(0, 0, 0, 0.9);
      padding: 12px;
      text-align: center;
      z-index: 999;
      border-top: 1px solid #00f0ff;
    }
    
    /* QR ìŠ¤ìºë„ˆì™€ ì…ë ¥ í•„ë“œë¥¼ í•œ í™”ë©´ì— ë°°ì¹˜í•˜ê¸° ìœ„í•œ ì»¨í…Œì´ë„ˆ */
    .scanner-form-container {
      display: flex;
      flex-direction: column;
      max-width: 480px;
      margin: 0 auto;
      position: relative;
      padding-bottom: 60px; /* í•˜ë‹¨ ë²„íŠ¼ì„ ìœ„í•œ ê³µê°„ */
    }
    
    /* QR ìŠ¤ìºë„ˆ ì˜ì—­ ìµœì í™” */
    #reader {
      width: 100%;
      max-height: 45vh;
      margin: 0 auto;
      overflow: hidden;
    }
    
    /* ì…ë ¥ í•„ë“œë¥¼ ì»´íŒ©íŠ¸í•˜ê²Œ ì •ë ¬ */
    .input-fields {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      margin-top: 8px;
      padding: 0 5px;
    }
    
    /* ìƒíƒœ ë° ìš”ì•½ ì •ë³´ í‘œì‹œ ì˜ì—­ */
    .status-container {
      margin-top: 8px;
      padding: 0 5px;
    }
    
    #status, #summary {
      margin: 5px 0;
      font-size: 0.9rem;
    }
    
    /* ëª¨ë°”ì¼ í™”ë©´ì—ì„œ ìµœì í™” */
    @media (max-width: 480px) {
      #reader {
        max-height: 38vh;
      }
      
      .scanner-form-container {
        height: calc(100vh - 130px);
        justify-content: space-between;
      }
      
      input {
        font-size: 14px;
        padding: 8px;
      }
      
      .action-buttons button {
        padding: 10px 15px;
        font-size: 15px;
      }
    }
    
    /* ê°€ë¡œ ëª¨ë“œì—ì„œëŠ” QR ìŠ¤ìºë„ˆì™€ ì…ë ¥ í¼ì„ ë‚˜ë€íˆ ë°°ì¹˜ */
    @media (min-width: 800px) and (orientation: landscape) {
      .scanner-form-container {
        flex-direction: row;
        max-width: 90%;
        align-items: flex-start;
        gap: 15px;
      }
      
      #reader {
        width: 60%;
        max-height: 70vh;
      }
      
      .form-container {
        width: 40%;
      }
      
      .input-fields {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div style="display: flex; justify-content: space-between; padding: 4px 8px; align-items: center;">
    <div id="sheetTitle" style="color: #00f0ff;">ğŸ“„ ì‹œíŠ¸ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
    <div>
      <button id="sheetButton" class="top-button">ì‹œíŠ¸</button>
      <button id="adminButton" class="top-button">ê´€ë¦¬ì</button>
<button id="changeSheetButton" class="top-button">ì‹œíŠ¸ ë³€ê²½</button>
    </div>
  </div>

  <!-- ì•± ì„¤ì¹˜ ì•ˆë‚´ ë°°ë„ˆ -->
  <div id="installBanner">
    <button class="banner-close" id="closeBanner">âœ•</button>
    <div class="banner-title">
      <span>ğŸ“±</span>
      <span>ì•± ì„¤ì¹˜ ì•ˆë‚´</span>
    </div>
    <p>ë” ë¹ ë¥´ê³  í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•˜ë ¤ë©´ ì•±ì„ ì„¤ì¹˜í•´ë³´ì„¸ìš”!</p>
    <button id="installButton">ì•± ì„¤ì¹˜í•˜ê¸°</button>
    
    <div id="installGuide" class="install-guide">
      <!-- ê¸°ê¸°ë³„ ì„¤ì¹˜ ê°€ì´ë“œëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ë™ì  ì‚½ì…ë¨ -->
    </div>
  </div>

  <!-- QR ìŠ¤ìºë„ˆì™€ ì…ë ¥ í•„ë“œë¥¼ í•œ ì»¨í…Œì´ë„ˆì— í†µí•© -->
  <div class="scanner-form-container">
    <div id="reader"></div>
    
    <div class="form-container">
      <div class="input-fields">
        <input id="code" placeholder="ìƒí’ˆì½”ë“œ" readonly />
        <input id="name" placeholder="ìƒí’ˆëª…" />
        <input id="quantity" type="number" placeholder="ìˆ˜ëŸ‰" value="1" />
        <input id="user" placeholder="ë‹´ë‹¹ìëª…" />
      </div>
      
      <div class="status-container">
        <p id="status"></p>
        <div id="summary"></div>
      </div>
    </div>
  </div>
  
  <!-- í•˜ë‹¨ì— ê³ ì •ëœ ì•¡ì…˜ ë²„íŠ¼ -->
  <div class="action-buttons">
    <button class="action ì…ê³ " onclick="setAction('ì…ê³ ')">ì…ê³ </button>
    <button class="action ì¶œê³ " onclick="setAction('ì¶œê³ ')">ì¶œê³ </button>
    <button class="action ë°˜í’ˆ" onclick="setAction('ë°˜í’ˆ')">ë°˜í’ˆ</button>
    <button class="action í•˜ì" onclick="setAction('í•˜ì')">í•˜ì</button>
  </div>

  <script src="qr.js">
if (!sheetId) {
  const saved = sessionStorage.getItem("sheetId");
  if (saved) {
    location.href = `qr.html?sheetId=${saved}`;
  }
}

</script>
  <script src="qr-fixed.js">
if (!sheetId) {
  const saved = sessionStorage.getItem("sheetId");
  if (saved) {
    location.href = `qr.html?sheetId=${saved}`;
  }
}

</script>
  <script>
    // COOP ì˜¤ë¥˜ í•´ê²°ì„ ìœ„í•œ ê°œì„ ëœ í•¨ìˆ˜
    async function getSheetAccessToken() {
      // ì´ë¯¸ ë¡œë“œëœ qr-fixed.jsì˜ getAccessToken í•¨ìˆ˜ ì‚¬ìš© ì‹œë„
      if (typeof getAccessToken === 'function') {
        return await getAccessToken();
      }
      
      // ë˜ëŠ” ì§ì ‘ êµ¬í˜„
      return new Promise((resolve) => {
        const cached = localStorage.getItem("accessToken");
        if (cached) {
          // ìºì‹œëœ í† í° ê²€ì¦
          fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetId}?fields=properties.title`, {
            headers: { Authorization: "Bearer " + cached }
          })
          .then(res => {
            if (res.ok) return resolve(cached);
            // ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ ìƒˆë¡œ ìš”ì²­
            localStorage.removeItem("accessToken");
            requestNewToken();
          })
          .catch(() => {
            localStorage.removeItem("accessToken");
            requestNewToken();
          });
        } else {
          requestNewToken();
        }
        
        function requestNewToken() {
          const tokenClient = google.accounts.oauth2.initTokenClient({
            client_id: "192783618509-d0ev6sp714cr4d43cfumfaum005g485t.apps.googleusercontent.com",
            scope: "https://www.googleapis.com/auth/spreadsheets", // ì „ì²´ ê¶Œí•œìœ¼ë¡œ í†µì¼
            callback: (res) => {
              if (res && res.access_token) {
                localStorage.setItem("accessToken", res.access_token);
                resolve(res.access_token);
              } else {
                resolve(null);
              }
            }
          });
          
          // ì´ì „ì— ë™ì˜í–ˆë‹¤ë©´ ì¡°ìš©íˆ ìš”ì²­
          tokenClient.requestAccessToken({prompt: ''});
        }
      });
    }

    document.addEventListener("DOMContentLoaded", async () => {
      const sheetId = new URLSearchParams(location.search).get("sheetId");
      const sheetTitle = document.getElementById("sheetTitle");
      const sheetBtn = document.getElementById("sheetButton");
      const adminBtn = document.getElementById("adminButton");

      sheetBtn.onclick = () => {
        if (sheetId) {
          window.open(`https://docs.google.com/spreadsheets/d/${sheetId}`, "_blank");
        } else {
          alert("âŒ ì‹œíŠ¸ IDê°€ ì—†ìŠµë‹ˆë‹¤.");
        }
      };

      adminBtn.onclick = () => {
        if (sheetId) {
          window.location.href = `admin.html?sheetId=${sheetId}`;
        } else {
          alert("âŒ ì‹œíŠ¸ IDê°€ ì—†ìŠµë‹ˆë‹¤.");
        }
      };

      // OAuth ì¸ì¦ì„ ì‚¬ìš©í•˜ì—¬ ì‹œíŠ¸ ì œëª© ê°€ì ¸ì˜¤ê¸°
      if (sheetId) {
        try {
          const token = await getSheetAccessToken();
          
          if (!token) {
            sheetTitle.innerText = "ğŸ“„ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤";
            return;
          }
          
          const response = await fetch(
            `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}?fields=properties.title`,
            { headers: { Authorization: `Bearer ${token}` } }
          );
          
          if (!response.ok) {
            throw new Error(`API ì˜¤ë¥˜: ${response.status}`);
          }
          
          const data = await response.json();
          sheetTitle.innerText = `ğŸ“„ ì—°ê²°ëœ ì‹œíŠ¸: ${data.properties.title}`;
        } catch (error) {
          console.error("ì‹œíŠ¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:", error);
          sheetTitle.innerText = "ğŸ“„ ì‹œíŠ¸ ì ‘ê·¼ ì˜¤ë¥˜ ë°œìƒ";
        }
      }
      
      // ì…ê³  ë²„íŠ¼ì„ ê¸°ë³¸ ì„ íƒìœ¼ë¡œ ì„¤ì •
      if (typeof setAction === 'function') {
        setTimeout(() => setAction('ì…ê³ '), 1000);
      }
    });

    // PWA ì„¤ì¹˜ ê´€ë ¨ ì½”ë“œ
    let deferredPrompt;
    const installButton = document.getElementById('installButton');
    const installBanner = document.getElementById('installBanner');
    const closeBanner = document.getElementById('closeBanner');
    const installGuide = document.getElementById('installGuide');

    // ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js')
          .then(reg => console.log('ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡ ì„±ê³µ:', reg.scope))
          .catch(err => console.log('ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡ ì‹¤íŒ¨:', err));
      });
    }

    // ìµœê·¼ì— ì„¤ì¹˜ ë°°ë„ˆë¥¼ ë‹«ì•˜ëŠ”ì§€ í™•ì¸ (3ì¼ê°„ ìœ íš¨)
    function hasRecentlyDismissedInstall() {
      const dismissedTime = parseInt(localStorage.getItem('installBannerDismissedTime') || '0');
      const now = Date.now();
      // 3ì¼(259,200,000 ë°€ë¦¬ì´ˆ) ë‚´ì— ë‹«ì•˜ìœ¼ë©´ true ë°˜í™˜
      return now - dismissedTime < 259200000;
    }

    // ë°°ë„ˆ ë‹«ê¸° ì´ë²¤íŠ¸
    closeBanner.addEventListener('click', () => {
      installBanner.style.display = 'none';
      localStorage.setItem('installBannerDismissedTime', Date.now().toString());
    });
    
    // ë¸Œë¼ìš°ì € ì¢…ë¥˜ ê°ì§€
    function detectBrowser() {
      const userAgent = navigator.userAgent;
      
      if (/iPhone|iPad|iPod/.test(userAgent) && !window.MSStream) {
        return 'safari';
      } else if (/Android/.test(userAgent)) {
        if (/NAVER/.test(userAgent)) {
          return 'naver';
        } else if (/whale/.test(userAgent)) {
          return 'whale';
        } else if (/SamsungBrowser/.test(userAgent)) {
          return 'samsung';
        } else if (/Chrome/.test(userAgent)) {
          return 'chrome';
        } else {
          return 'android-other';
        }
      } else if (/Chrome/.test(userAgent)) {
        return 'chrome';
      } else if (/Firefox/.test(userAgent)) {
        return 'firefox';
      } else if (/Edge|Edg/.test(userAgent)) {
        return 'edge';
      } else {
        return 'unknown';
      }
    }
    
    // ë¸Œë¼ìš°ì €ë³„ ì„¤ì¹˜ ê°€ì´ë“œ ìƒì„±
    function createInstallGuide() {
      const browser = detectBrowser();
      let guideHtml = '';
      
      switch(browser) {
        case 'safari':
          guideHtml = `
            <strong>ì‚¬íŒŒë¦¬ì—ì„œ ì„¤ì¹˜í•˜ê¸°:</strong><br>
            1. í•˜ë‹¨ ê³µìœ  ë²„íŠ¼ <span style="font-size:18px">â«</span> íƒ­<br>
            2. "í™ˆ í™”ë©´ì— ì¶”ê°€" ì„ íƒ
          `;
          break;
        case 'chrome':
          guideHtml = `
            <strong>í¬ë¡¬ì—ì„œ ì„¤ì¹˜í•˜ê¸°:</strong><br>
            1. ë©”ë‰´ <span style="font-size:18px">â‹®</span> íƒ­<br>
            2. "ì•± ì„¤ì¹˜" ë˜ëŠ” "í™ˆ í™”ë©´ì— ì¶”ê°€" ì„ íƒ
          `;
          break;
        case 'naver':
          guideHtml = `
            <strong>ë„¤ì´ë²„ ì›¨ì¼ì—ì„œ ì„¤ì¹˜í•˜ê¸°:</strong><br>
            1. ë©”ë‰´ <span style="font-size:18px">â‹®</span> íƒ­<br>
            2. "í™ˆ í™”ë©´ì— ì¶”ê°€" ì„ íƒ
          `;
          break;
        case 'whale':
          guideHtml = `
            <strong>ë„¤ì´ë²„ ì›¨ì¼ì—ì„œ ì„¤ì¹˜í•˜ê¸°:</strong><br>
            1. ë©”ë‰´ <span style="font-size:18px">â‹®</span> íƒ­<br>
            2. "í™ˆ í™”ë©´ì— ì¶”ê°€" ì„ íƒ
          `;
          break;
        case 'samsung':
          guideHtml = `
            <strong>ì‚¼ì„± ì¸í„°ë„·ì—ì„œ ì„¤ì¹˜í•˜ê¸°:</strong><br>
            1. ë©”ë‰´ <span style="font-size:18px">â‰¡</span> íƒ­<br>
            2. "í™ˆ í™”ë©´ì— ì¶”ê°€" ì„ íƒ
          `;
          break;
        case 'firefox':
          guideHtml = `
            <strong>íŒŒì´ì–´í­ìŠ¤ì—ì„œ ì„¤ì¹˜í•˜ê¸°:</strong><br>
            1. ë©”ë‰´ <span style="font-size:18px">â‰¡</span> íƒ­<br>
            2. "ì•± ì„¤ì¹˜" ë˜ëŠ” "í™ˆ í™”ë©´ì— ì¶”ê°€" ì„ íƒ
          `;
          break;
        case 'edge':
          guideHtml = `
            <strong>ì—£ì§€ì—ì„œ ì„¤ì¹˜í•˜ê¸°:</strong><br>
            1. ë©”ë‰´ <span style="font-size:18px">â€¦</span> íƒ­<br>
            2. "ì•± ì„¤ì¹˜" ì„ íƒ
          `;
          break;
        default:
          guideHtml = `
            <strong>ì•± ì„¤ì¹˜ ë°©ë²•:</strong><br>
            ë¸Œë¼ìš°ì € ë©”ë‰´ì—ì„œ "ì•± ì„¤ì¹˜" ë˜ëŠ”<br>
            "í™ˆ í™”ë©´ì— ì¶”ê°€" ì˜µì…˜ì„ ì°¾ì•„ ì„ íƒí•˜ì„¸ìš”.
          `;
      }
      
      installGuide.innerHTML = guideHtml;
    }

    // ì„¤ì¹˜ ì•ˆë‚´ í‘œì‹œ ì—¬ë¶€ ê²°ì • ë° í‘œì‹œ
    function showInstallPromotion() {
      // ì´ë¯¸ ì•±ì´ ì„¤ì¹˜ë˜ì–´ ìˆê±°ë‚˜ ìµœê·¼ì— ë°°ë„ˆë¥¼ ë‹«ì€ ê²½ìš°ëŠ” í‘œì‹œí•˜ì§€ ì•ŠìŒ
      if (window.matchMedia('(display-mode: standalone)').matches || 
          window.navigator.standalone === true ||
          localStorage.getItem('appInstalled') === 'true' ||
          hasRecentlyDismissedInstall()) {
        return;
      }
      
      // ì„¤ì¹˜ ê°€ì´ë“œ ìƒì„±
      createInstallGuide();
      
      // ì„¤ì¹˜ ë°°ë„ˆ í‘œì‹œ
      installBanner.style.display = 'block';
    }

    // ì•± ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ í‘œì‹œ
    window.addEventListener('beforeinstallprompt', (e) => {
      // ë¸Œë¼ìš°ì € ê¸°ë³¸ ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ë°©ì§€
      e.preventDefault();
      // ì´ë²¤íŠ¸ ì €ì¥
      deferredPrompt = e;
      
      // ì„¤ì¹˜ ì•ˆë‚´ í‘œì‹œ
      showInstallPromotion();
    });

    // ì„¤ì¹˜ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
    installButton.addEventListener('click', async () => {
      if (deferredPrompt) {
        // ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ í‘œì‹œ
        deferredPrompt.prompt();
        // ì‚¬ìš©ì ì‘ë‹µ ëŒ€ê¸°
        const { outcome } = await deferredPrompt.userChoice;
        console.log(`ì‚¬ìš©ì ì„ íƒ: ${outcome}`);
        // ì´ë²¤íŠ¸ ì°¸ì¡° ì •ë¦¬
        deferredPrompt = null;
        // ì„¤ì¹˜ ë°°ë„ˆ ìˆ¨ê¸°ê¸°
        installBanner.style.display = 'none';
      } else {
        // beforeinstallpromptê°€ ì§€ì›ë˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì˜ ê²½ìš°
        // ìˆ˜ë™ ì„¤ì¹˜ ê°€ì´ë“œë§Œ í‘œì‹œ
        alert('ë¸Œë¼ìš°ì € ë©”ë‰´ë¥¼ ì´ìš©í•˜ì—¬ ì•±ì„ ì„¤ì¹˜í•´ì£¼ì„¸ìš”.');
      }
    });

    // ì•±ì´ ì´ë¯¸ ì„¤ì¹˜ëœ ê²½ìš°
    window.addEventListener('appinstalled', () => {
      console.log('ì•±ì´ ì„¤ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤!');
      installBanner.style.display = 'none';
      localStorage.setItem('appInstalled', 'true');
    });

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì„¤ì¹˜ ì•ˆë‚´ í‘œì‹œ
    window.addEventListener('load', () => {
      // iOSì—ì„œëŠ” beforeinstallpromptê°€ ì§€ì›ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì§ì ‘ ì„¤ì¹˜ ì•ˆë‚´ í‘œì‹œ
      if (/iPhone|iPad|iPod/.test(navigator.userAgent) && !window.MSStream) {
        if (!window.navigator.standalone && 
            localStorage.getItem('appInstalled') !== 'true' && 
            !hasRecentlyDismissedInstall()) {
          createInstallGuide();
          installBanner.style.display = 'block';
        }
      } else {
        // beforeinstallprompt ì´ë²¤íŠ¸ê°€ ì§€ì›ë˜ëŠ” ë¸Œë¼ìš°ì €ëŠ” í•´ë‹¹ ì´ë²¤íŠ¸ì—ì„œ ì²˜ë¦¬
        showInstallPromotion();
      }
    });
  
if (!sheetId) {
  const saved = sessionStorage.getItem("sheetId");
  if (saved) {
    location.href = `qr.html?sheetId=${saved}`;
  }
}

</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const changeSheetBtn = document.getElementById("changeSheetButton");
    if (changeSheetBtn) {
      changeSheetBtn.addEventListener("click", () => {
        sessionStorage.removeItem("sheetId"); // ê¸°ì¡´ ì‹œíŠ¸ID ì œê±°
        window.location.href = "index.html";
      });
    }
  });

if (!sheetId) {
  const saved = sessionStorage.getItem("sheetId");
  if (saved) {
    location.href = `qr.html?sheetId=${saved}`;
  }
}

</script>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const changeSheetBtn = document.getElementById("changeSheetButton");
  if (changeSheetBtn) {
    changeSheetBtn.addEventListener("click", () => {
      sessionStorage.removeItem("sheetId");
      window.location.replace("index.html?nocache=" + Date.now());
    });
  }
});
</script>
</body>
</html>
